# Переключение пользователей и root

Базовые варианты
- `sudo -i` — «login shell» root (загружает профиль root). Предпочтительно.
- `sudo -s` — root‑шелл с сохранением части окружения текущего пользователя.
- `sudo -u <user> -- <cmd>` — запустить команду от имени другого пользователя.
- `su - <user>` — переключиться с запросом пароля целевого пользователя (часто недоступно для root, т.к. root без пароля/заблокирован).

Практика
- Разовая команда как другой пользователь:
  - `sudo -u www-data -- sh -lc 'php bin/console cache:clear --env=prod'`
- Войти под root для администрирования:
  - `sudo -i`
- Войти под конкретного пользователя с «логин‑сессией»:
  - `sudo -u deploy -H -s` (интерактивный шелл)
  - или `sudo -u deploy -H -- sh -l` (явный login‑шелл)

Чем отличаются `sudo -i` и `sudo -s`
- `-i` имитирует полноценный вход: меняет `HOME`, инициализирует окружение, выполняет профиль.
- `-s` стартует шелл root, но может оставить PATH/ALIases от исходного пользователя.

Полезные проверки
- Текущий пользователь: `whoami`
- Эффективные UID/GID: `id`
- Какой шелл: `echo $SHELL`

Анти‑паттерны
- Не включайте постоянный шелл/пароль для `www-data`.
- Не работайте под root на постоянной основе — только на время операций.

[[Пользователь www-data]]
[[Права доступа]]
