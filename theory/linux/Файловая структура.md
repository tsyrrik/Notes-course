# Файловая структура Linux (Ubuntu) для PHP backend-разработчика

Ниже — практичная шпаргалка по каталогам и файлам Ubuntu/Debian‑семейства, с акцентом на PHP, PHP‑FPM, Nginx/Apache, БД и логи. Цель — знать «куда смотреть» и «что править» в типичном прод/стейдж/дев окружении.

## Картина мира (FHS — основные каталоги)
- `/` — корень файловой системы.
- `/etc` — системные конфиги. Ищем настройки сервисов именно здесь.
- `/var` — изменяемые данные: логи, базы, очереди, кэш, PID/sock’и.
- `/var/log` — системные и сервисные логи.
- `/var/www` — часто используют как корень для web‑проектов (не обязательно).
- `/var/lib` — данные сервисов (MySQL/PostgreSQL/Redis и т.п.).
- `/run` (ранее `/var/run`) — runtime‑сокеты/PID (tmpfs, очищается при перезагрузке).
- `/tmp` — временные файлы, очищаются агрессивно; `/var/tmp` — хранит дольше.
- `/usr` — установленное ПО и библиотеки; `/usr/local` — локально установленное.
- `/bin`, `/sbin`, `/usr/bin` — исполняемые файлы.
- `/lib`, `/usr/lib` — библиотеки; PHP расширения `.so` обычно здесь.
- `/home` — домашние каталоги пользователей.
- `/opt`, `/srv` — иногда используют для самостоятельных установок/сервисов.
- `/dev`, `/proc`, `/sys` — спец. файловые системы (устройства/ядро/псевдо‑файлы).
- `/etc/fstab` — правила монтирования; `mount`, `df -h` — диагностика дисков.

Полезно: `man hier` — краткая справка по иерархии файловой системы.

## Веб‑серверы
### Nginx
- Конфиги: `/etc/nginx/`
  - Главный: `/etc/nginx/nginx.conf`
  - Вирт‑хосты: `/etc/nginx/sites-available/` + симлинки в `/etc/nginx/sites-enabled/`
  - Общие сниппеты: `/etc/nginx/snippets/`, доп. включения: `/etc/nginx/conf.d/`
- Логи: `/var/log/nginx/access.log`, `/var/log/nginx/error.log`
- Док‑рут по умолчанию: `/var/www/html` (может отличаться)
- Сервис: `systemctl status nginx`, юнит: `nginx.service`
- TLS/SSL: системные сертификаты — `/etc/ssl/`; Let’s Encrypt — `/etc/letsencrypt/`

## PHP и PHP‑FPM
Все что может понадобиться - найти php.ini. проще всего это сделать командой
php -i | grep php.ini
Потому что конфигов может быть много, не оч очевидно какой загружен в работу
Если php бинарник не добавлен в path переменную твоего пользователя, поможет which php

Права и пользователи:
- Веб/PHP‑FPM обычно под пользователем/группой `www-data`.

Composer:
- Конфиги/кэш: `~/.config/composer/` и `~/.cache/composer/` (иногда `~/.composer/`)
- Глобальные пакеты: `~/.config/composer/vendor/`

## Базы данных и кеши
### MySQL/MariaDB
- Данные: `/var/lib/mysql/`
- Конфиги: `/etc/mysql/` и `/etc/mysql/mysql.conf.d/*.cnf`
- Сервис: `mysql.service`/`mariadb.service`
- Логи: `/var/log/mysql/*.log` или `journalctl -u mysql -f`

### PostgreSQL
- Данные: `/var/lib/postgresql/<версия>/main/`
- Конфиги: `/etc/postgresql/<версия>/main/*.conf` (postgresql.conf, pg_hba.conf)
- Сервис: `postgresql.service`
- Логи: `/var/log/postgresql/postgresql-<версия>-main.log` либо journald

## Сервисы и автозапуск (systemd)
- Юниты пакетов: `/lib/systemd/system/*.service`
- Пользовательские/override: `/etc/systemd/system/*.service`
- Просмотр/перезапуск: `systemctl status|start|stop|restart <service>`
- Автозапуск: `systemctl enable|disable <service>`
- Override без редактирования исходного юнита: `systemctl edit <service>` (создаст `/etc/systemd/system/<service>.d/override.conf`)

Supervisor (часто для воркеров):
- Конфиги: `/etc/supervisor/supervisord.conf`, `conf.d/*.conf`
- Управление: `supervisorctl status|start|stop|restart <program>`
- Логи: `/var/log/supervisor/`

## Пакетный менеджер APT
- Источники: `/etc/apt/sources.list`, дополнительные: `/etc/apt/sources.list.d/*.list`
- Кэш пакетов: `/var/cache/apt/archives/`
- Логи apt: `/var/log/apt/`
- Полезно: `dpkg -L <pkg>` — какие файлы установил пакет; `dpkg -S <path>` — какой пакет владеет файлом.

## Сеть 
- dns: `/etc/hosts`

## SSL/TLS и брандмауэр
- Let’s Encrypt: `/etc/letsencrypt/` (сертификаты/ключи/конфиги certbot)

## Временные файлы и очистка
- `/tmp` — чистится автоматически чаще; `/var/tmp` — живёт дольше (перезагрузки).
- `systemd-tmpfiles` управляет политиками очистки (`/etc/tmpfiles.d/*.conf`, `/usr/lib/tmpfiles.d/*.conf`).
- Очистка места:
  - `du -sh /var/log/* | sort -h`, `journalctl --disk-usage`
  - `apt-get clean`
  - Docker (если есть): `/var/lib/docker/` может разрастаться

## Где жить проектам
- Часто: `/var/www/<project>` (владение/группа: `deploy:www-data` или `www-data:www-data`).
- Важное: только необходимые папки делаем пишущими для `www-data` (Laravel: `storage/`, `bootstrap/cache/`; Symfony: `var/`). Остальное — read‑only.
- Для деплоя удобно:
  - Отдельный пользователь `deploy` (без shell/с ограничениями).
  - `sudo` только на нужные команды (править через `visudo`).
  - Ротация логов, мониторинг места на диске, резервные копии.

## Настройка окружения пользователя
- Профиль пользователя: `~/.profile`, интерактивная оболочка bash: `~/.bashrc`

## См. также
- [[Смена владельца и прав на файлы]] — `chown`, `chmod`, `setfacl` для прод‑окружений.
- [[Переключение пользователей и root]] — `sudo`, `su`, безопасные практики.
