**–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –æ–¥–Ω–æ–≥–æ —É–∑–ª–∞ (primary/master)  
–Ω–∞ –¥—Ä—É–≥–æ–π (replica/standby), —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å **–æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**,  
**–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ **–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** —Å–∏—Å—Ç–µ–º—ã.

---

### 1. –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è

- üîÅ **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** ‚Äî –µ—Å–ª–∏ —É–ø–∞–ª –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä, replica –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –Ω–æ–≤—ã–º master.
    
- ‚ö° **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏** ‚Äî —á–∏—Ç–∞–µ–º —Å —Ä–µ–ø–ª–∏–∫, –ø–∏—à–µ–º –≤ –º–∞—Å—Ç–µ—Ä.
    
- üì¶ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –ø–æ—á—Ç–∏ ‚Äú–∂–∏–≤–æ–π‚Äù –±—ç–∫–∞–ø.
    
- üåç **–ì–µ–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** ‚Äî —É–∑–ª—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è latency.
    

> –ü–æ—á—Ç–∏ –∫–∞–∂–¥–∞—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (PostgreSQL, Kafka, Redis, RabbitMQ, Elasticsearch, ClickHouse)  
> —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–∞–∫—É—é-—Ç–æ —Ñ–æ—Ä–º—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏.

---

### 2. –¢–∏–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

|–¢–∏–ø|–ü—Ä–∏–Ω—Ü–∏–ø|–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏|
|---|---|---|
|**–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è**|–º–∞—Å—Ç–µ—Ä –∂–¥—ë—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç —Ä–µ–ø–ª–∏–∫–∏|–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ|
|**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è**|–º–∞—Å—Ç–µ—Ä –Ω–µ –∂–¥—ë—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è|–±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–∞ –ø–æ—Ç–µ—Ä—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π|
|**–ü–æ–ª—É—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è**|–∂–¥—ë—Ç –º–∏–Ω–∏–º—É–º 1 —Ä–µ–ø–ª–∏–∫—É, –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ|–∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é|

---

### 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –≤ PostgreSQL

#### –ú–µ—Ö–∞–Ω–∏–∑–º WAL (Write-Ahead Log)

1. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –∂—É—Ä–Ω–∞–ª (`pg_wal`).
    
2. –≠—Ç–∏ –∑–∞–ø–∏—Å–∏ (WAL-—Å–µ–≥–º–µ–Ω—Ç—ã) —Å—Ç—Ä–∏–º—è—Ç—Å—è –Ω–∞ —Ä–µ–ø–ª–∏–∫—É.
    
3. –†–µ–ø–ª–∏–∫–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö –∫ —Å–≤–æ–∏–º –¥–∞–Ω–Ω—ã–º, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞.
    

> –≠—Ç–æ **–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π**, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤.

---

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–π (streaming) —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

#### –ù–∞ –º–∞—Å—Ç–µ—Ä–µ (`postgresql.conf`):

```ini
wal_level = replica
max_wal_senders = 10
wal_keep_size = 256MB
archive_mode = on
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–µ–ø–ª–∏–∫–∏:

```sql
CREATE ROLE replicator WITH REPLICATION LOGIN PASSWORD 'secret';
```

#### –ù–∞ —Ä–µ–ø–ª–∏–∫–µ (`recovery.conf` –∏–ª–∏ `standby.signal`):

```ini
primary_conninfo = 'host=master user=replicator password=secret'
primary_slot_name = 'replica1'
```

> –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ replica –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –º–∞—Å—Ç–µ—Ä—É –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å—Ç—Ä–∏–º–∏—Ç—å WAL-–∑–∞–ø–∏—Å–∏.

---

### 5. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤ (replication slots)

Postgres –º–æ–∂–µ—Ç ‚Äú—É–¥–µ—Ä–∂–∏–≤–∞—Ç—å‚Äù WAL-—Ñ–∞–π–ª—ã –¥–æ —Ç–µ—Ö –ø–æ—Ä,  
–ø–æ–∫–∞ —Ä–µ–ø–ª–∏–∫–∞ –∏—Ö –Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç ‚Äî —á—Ç–æ–±—ã —Ç–∞ –Ω–µ –æ—Ç—Å—Ç–∞–ª–∞ –Ω–∞–≤—Å–µ–≥–¥–∞.

```sql
SELECT * FROM pg_create_physical_replication_slot('replica1');
```

> –ë–µ–∑ —Å–ª–æ—Ç–∞ –æ—Ç—Å—Ç–∞–≤—à–∞—è —Ä–µ–ø–ª–∏–∫–∞ –º–æ–∂–µ—Ç ‚Äú–ø–æ—Ç–µ—Ä—è—Ç—å—Å—è‚Äù,  
> –µ—Å–ª–∏ WAL-—Ñ–∞–π–ª—ã —É–∂–µ —É–¥–∞–ª–µ–Ω—ã –Ω–∞ –º–∞—Å—Ç–µ—Ä–µ.

---

### 6. –õ–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è (logical replication)

–ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å **–Ω–µ –≤–µ—Å—å –∫–ª–∞—Å—Ç–µ—Ä**, –∞ —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ —Å—Ö–µ–º—ã.  
–†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö `pgoutput` –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –±–∏–Ω–∞—Ä–Ω–æ–π –ø–æ—Ç–æ–∫–æ–≤–æ–π —Ä–µ–ø–ª–∏–∫–∏).

#### –ù–∞ –º–∞—Å—Ç–µ—Ä–µ:

```sql
CREATE PUBLICATION my_pub FOR TABLE users, orders;
```

#### –ù–∞ —Ä–µ–ø–ª–∏–∫–µ:

```sql
CREATE SUBSCRIPTION my_sub
CONNECTION 'host=master user=replicator dbname=app password=secret'
PUBLICATION my_pub;
```

> –≠—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (ETL, CDC, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞).

---

### 7. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è ‚â† –ë—ç–∫–∞–ø

–†–µ–ø–ª–∏–∫–∞—Ü–∏—è –Ω–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö:

- –µ—Å–ª–∏ —Ç—ã —Å–ª—É—á–∞–π–Ω–æ `DELETE FROM users;` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —É–π–¥—ë—Ç –∏ –Ω–∞ —Ä–µ–ø–ª–∏–∫—É.
    
- –ø–æ—ç—Ç–æ–º—É **—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–æ–ø–æ–ª–Ω—è–µ—Ç, –Ω–æ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç** —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (pg_dump, basebackup).
    

---

### 8. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –≤ –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

–ü–æ—á—Ç–∏ –∫–∞–∂–¥–∞—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã:

|–°–∏—Å—Ç–µ–º–∞|–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è|–ü—Ä–∏–Ω—Ü–∏–ø|
|---|---|---|
|**Kafka**|ISR (in-sync replicas)|–±—Ä–æ–∫–µ—Ä—ã —Ö—Ä–∞–Ω—è—Ç –∫–æ–ø–∏–∏ –ø–∞—Ä—Ç–∏—Ü–∏–π|
|**Redis**|Master-Replica|repl backlog, async replication|
|**RabbitMQ**|Queue Mirroring / Quorum Queues|—Å–æ–æ–±—â–µ–Ω–∏—è —Ä–µ–ø–ª–∏—Ü–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏|
|**Elasticsearch**|Shard replication|—Ä–µ–ø–ª–∏–∫–∏ —à–∞—Ä–¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã|
|**ClickHouse**|ReplicatedMergeTree|—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ DDL —á–µ—Ä–µ–∑ ZooKeeper|

–û–±—â–∞—è –∏–¥–µ—è ‚Äî **—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è**  
–∏ **–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–∏–π** –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É–∑–ª–∞—Ö.

---

### 9. Failover –∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É master –∏ replica –∏—Å–ø–æ–ª—å–∑—É—é—Ç:

- **Patroni**, **repmgr**, **pg_auto_failover** (–¥–ª—è PostgreSQL);
    
- –∏–ª–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä—ã —Ç–∏–ø–∞ **Stolon**, **Pgpool-II**, **HAProxy** –ø–µ—Ä–µ–¥ —Ä–µ–ø–ª–∏–∫–∞–º–∏.
    

> –ë–µ–∑ failover ‚Äî —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –∑–∞—â–∏—â–∞–µ—Ç, –Ω–æ –Ω–µ ‚Äú–∏—Å—Ü–µ–ª—è–µ—Ç‚Äù —Å–∏—Å—Ç–µ–º—É.

---

### 10. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- `pg_stat_replication` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∞–≥ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, —Å—Ç–∞—Ç—É—Å —Å—Ç—Ä–∏–º–∞.
    
- `pg_stat_wal_receiver` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏—ë–º–Ω–∏–∫–∞ WAL.
    
- Prometheus + `postgres_exporter` ‚Üí –¥–∞—à–±–æ—Ä–¥—ã –≤ Grafana.
    

---

### üí° –í –æ–¥–Ω–æ–π —Ñ—Ä–∞–∑–µ

> **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –Ω–µ –∫–æ–ø–∏–ø–∞—Å—Ç –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ ‚Äú–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π‚Äù,  
> —á—Ç–æ–±—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ —É–∑–ª–æ–≤ –≤—Å–µ–≥–¥–∞ —à–ª–∏ –≤ –Ω–æ–≥—É.  
> –û—Ç PostgreSQL –¥–æ Kafka, Redis –∏ RabbitMQ ‚Äî —Å—É—Ç—å –æ–¥–Ω–∞:  
> **–ª–æ–≥ —Å–æ–±—ã—Ç–∏–π + –¥–æ—Å—Ç–∞–≤–∫–∞ + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è**.