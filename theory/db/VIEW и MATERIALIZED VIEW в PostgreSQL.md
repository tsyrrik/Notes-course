**View** ‚Äî —ç—Ç–æ ‚Äú–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞‚Äù, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ SQL-–∑–∞–ø—Ä–æ—Å–µ.  
**Materialized View** ‚Äî —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫**,  
–∏ —á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω –≤—Ä—É—á–Ω—É—é.

---

### 1. VIEW (–æ–±—ã—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)

```sql
CREATE VIEW active_users AS
SELECT id, email, last_login
FROM users
WHERE is_active = true;
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–µ–º—É –∫–∞–∫ –∫ —Ç–∞–±–ª–∏—Ü–µ:

```sql
SELECT * FROM active_users WHERE last_login > now() - interval '7 days';
```

#### ‚öôÔ∏è –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º

- `VIEW` **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ**, –∞ —Ç–æ–ª—å–∫–æ SQL-–∑–∞–ø—Ä–æ—Å.
    
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º `SELECT` –∏–∑ view ‚Äî –∑–∞–ø—Ä–æ—Å **–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ**.
    
- –ü–æ —Å—É—Ç–∏, —ç—Ç–æ ‚Äú—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π SELECT‚Äù, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ SQL-–ø–ª–∞–Ω.
    

#### üëç –ü–ª—é—Å—ã

- –í—Å–µ–≥–¥–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
    
- –£–¥–æ–±–Ω–æ –¥–ª—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
    
- –ú–æ–∂–Ω–æ –¥–∞–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ view –≤–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å).
    

#### üëé –ú–∏–Ω—É—Å—ã

- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ ‚Äî –Ω–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏—è.
    
- –ü—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö –¥–∂–æ–π–Ω–∞—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ.
    

---

### 2. MATERIALIZED VIEW (–º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)

```sql
CREATE MATERIALIZED VIEW daily_stats AS
SELECT date_trunc('day', created_at) AS day, count(*) AS signups
FROM users
GROUP BY 1;
```

–≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç **—Ä–µ–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É** —Å –¥–∞–Ω–Ω—ã–º–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞.  
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–Ω–∞ **–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**.

–û–±–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

```sql
REFRESH MATERIALIZED VIEW daily_stats;
```

---

### 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏

|–¢–∏–ø|–ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ|–ö–æ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è|
|---|---|---|
|**VIEW**|–ù–µ —Ö—Ä–∞–Ω—è—Ç—Å—è ‚Äî –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏|–í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã|
|**MATERIALIZED VIEW**|–•—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ (–∫–∞–∫ snapshot)|–¢–æ–ª—å–∫–æ –ø—Ä–∏ `REFRESH`|

Materialized View –≤ PostgreSQL —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç **—Ç–∞–±–ª–∏—Ü—É –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º**,  
—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –≤ –≤–∏–¥–µ heap-—Å—Ç—Ä–∞–Ω–∏—Ü.  
–ü—Ä–∏ `REFRESH` –æ–Ω–∞:

1. –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç,
    
2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ä—É—é –∫–æ–ø–∏—é –Ω–æ–≤–æ–π,
    
3. –ë–ª–æ–∫–∏—Ä—É–µ—Ç —á—Ç–µ–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ `CONCURRENTLY`).
    

---

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

```sql
REFRESH MATERIALIZED VIEW CONCURRENTLY daily_stats;
```

‚ö†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å** –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.
    
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.
    

---

### 5. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

|–°—Ü–µ–Ω–∞—Ä–∏–π|–ü–æ–¥—Ö–æ–¥|
|---|---|
|–ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ç—è–∂—ë–ª—ã–π –∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞)|**Materialized View**|
|–ü—Ä–æ—Å—Ç–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è, –≥–¥–µ –Ω—É–∂–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å|**View**|
|–ù—É–∂–µ–Ω –∫—ç—à –æ—Ç—á—ë—Ç–∞, –æ–±–Ω–æ–≤–ª—è–µ–º—ã–π –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é|**Materialized View + cron/trigger**|
|–£–ø—Ä–æ—â–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –¥–∂–æ–π–Ω–æ–≤ –¥–ª—è dev –∏–ª–∏ BI|**View**|

---

### 6. –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### üìä –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```sql
CREATE MATERIALIZED VIEW user_activity_summary AS
SELECT
  user_id,
  date_trunc('day', occurred_at) AS day,
  count(*) AS actions
FROM events
GROUP BY user_id, day;

-- –∏–Ω–¥–µ–∫—Å –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏
CREATE UNIQUE INDEX idx_user_activity_summary ON user_activity_summary (user_id, day);

-- –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ cron, –Ω–∞–ø—Ä–∏–º–µ—Ä):
REFRESH MATERIALIZED VIEW CONCURRENTLY user_activity_summary;
```

---

### 7. –°–æ–≤–µ—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- Materialized view –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `WHERE` –∏–ª–∏ `ORDER BY` –±–µ–∑ `SELECT`.
    
- –ú–æ–∂–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—è materialized view.
    
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `INSERT`, `UPDATE`, `DELETE` –Ω–∞–ø—Ä—è–º—É—é.
    
- –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ñ–æ–Ω–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **pg_cron** –∏–ª–∏ **pgagent**.
    
- –î–ª—è real-time –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ª—É—á—à–µ **incremental refresh** (—á–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ `NOTIFY/LISTEN`).
    

---

### üí° –í –æ–¥–Ω–æ–π —Ñ—Ä–∞–∑–µ

> **VIEW** ‚Äî —ç—Ç–æ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑.
> **MATERIALIZED VIEW** ‚Äî —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –Ω–∞ –¥–∏—Å–∫,
> –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é.

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [[Triggers]] ‚Äî `INSTEAD OF`-—Ç—Ä–∏–≥–≥–µ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.
- [[–•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã (stored procedures)]] ‚Äî –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è materialized view –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.
- [[–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Window Functions)]] ‚Äî —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

