## 

**OAuth 2.0** โ ััะพ _ะฟัะพัะพะบะพะป ะฐะฒัะพัะธะทะฐัะธะธ_ (ะฐ ะฝะต ะฐััะตะฝัะธัะธะบะฐัะธะธ),  
ะบะพัะพััะน ะฟะพะทะฒะพะปัะตั ะฟัะธะปะพะถะตะฝะธั ะฟะพะปััะธัั **ะพะณัะฐะฝะธัะตะฝะฝัะน ะดะพัััะฟ** ะบ ะดะฐะฝะฝัะผ ะฟะพะปัะทะพะฒะฐัะตะปั  
ะฝะฐ ััะพัะพะฝะฝะตะผ ัะตัะฒะธัะต โ **ะฑะตะท ะฟะตัะตะดะฐัะธ ะฟะฐัะพะปั**.

---

### 1. ะกััั

OAuth ัะตัะฐะตั ะทะฐะดะฐัั:

> โะะฐะบ ะดะฐัั ะดััะณะพะผั ะฟัะธะปะพะถะตะฝะธั ะดะพัััะฟ ะบ ะผะพะธะผ ะดะฐะฝะฝัะผ,  
> ะฝะพ ะฝะต ะพัะดะฐะฒะฐั ะปะพะณะธะฝ ะธ ะฟะฐัะพะปั?โ

ะะฐะฟัะธะผะตั:

- ัั ะฒัะพะดะธัั ะฝะฐ ัะฐะนั ัะตัะตะท **โLogin with Googleโ**;
    
- ัะฐะนั ะฝะต ัะทะฝะฐัั ัะฒะพะน ะฟะฐัะพะปั ะพั Google;
    
- Google ะฒัะดะฐัั ัะฐะนัั **ัะพะบะตะฝ**, ัะฐะทัะตัะฐััะธะน ะดะพัััะฟ ะบ ะพะฟัะตะดะตะปัะฝะฝัะผ ะดะฐะฝะฝัะผ (ะฝะฐะฟัะธะผะตั, email).
    

---

### 2. ะัะฝะพะฒะฝัะต ััะฐััะฝะธะบะธ

|ะะพะปั|ะัะพ ััะพ|
|---|---|
|**Resource Owner**|ะะพะปัะทะพะฒะฐัะตะปั|
|**Client**|ะัะธะปะพะถะตะฝะธะต, ะบะพัะพัะพะต ัะพัะตั ะดะพัััะฟ ะบ ะดะฐะฝะฝัะผ|
|**Authorization Server**|ะกะตัะฒะตั, ะบะพัะพััะน ะฒัะดะฐะตั ัะพะบะตะฝั (ะฝะฐะฟัะธะผะตั, accounts.google.com)|
|**Resource Server**|API, ะบะพัะพััะน ััะฐะฝะธั ะทะฐัะธััะฝะฝัะต ะดะฐะฝะฝัะต (ะฝะฐะฟัะธะผะตั, Google Drive API)|

---

### 3. ะะพัะพะบะธ (Grant Types)

|ะะพัะพะบ|ะะฟะธัะฐะฝะธะต|ะะดะต ะธัะฟะพะปัะทัะตััั|
|---|---|---|
|**Authorization Code**|ะะพะปัะทะพะฒะฐัะตะปั ะปะพะณะธะฝะธััั ะฝะฐ ััะพัะพะฝะฝะตะผ ัะฐะนัะต โ ะฒัะดะฐะตััั ะบะพะด โ ะฟัะธะปะพะถะตะฝะธะต ะพะฑะผะตะฝะธะฒะฐะตั ะตะณะพ ะฝะฐ ัะพะบะตะฝ|ะะตะฑ-ะฟัะธะปะพะถะตะฝะธั|
|**PKCE (Proof Key for Code Exchange)**|ะะตะทะพะฟะฐัะฝะฐั ะฒะตััะธั ะฟัะตะดัะดััะตะณะพ, ะฑะตะท ััะฐะฝะตะฝะธั client secret|SPA, ะผะพะฑะธะปัะฝัะต ะฟัะธะปะพะถะตะฝะธั|
|**Client Credentials**|ะัะธะปะพะถะตะฝะธะต ัะฐะผะพ ะฟะพะปััะฐะตั ัะพะบะตะฝ (ะฑะตะท ััะฐััะธั ะฟะพะปัะทะพะฒะฐัะตะปั)|ะกะตัะฒะธั-ัะตัะฒะธั|
|**Password Grant** _(ัััะฐัะตะฒัะธะน)_|ะัะธะปะพะถะตะฝะธะต ะฟะพะปััะฐะตั ะปะพะณะธะฝ ะธ ะฟะฐัะพะปั ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะฐะฟััะผัั|ะขะพะปัะบะพ ะฒะพ ะฒะฝัััะตะฝะฝะธั ัะธััะตะผะฐั|
|**Refresh Token**|ะะฑะฝะพะฒะปะตะฝะธะต access token ะฑะตะท ััะฐััะธั ะฟะพะปัะทะพะฒะฐัะตะปั|ะะปั โะดะพะปะณะพะถะธะฒััะธัโ ัะตััะธะน|

---

### 4. ะะฐะบ ัะฐะฑะพัะฐะตั Authorization Code Flow

1. ะะพะปัะทะพะฒะฐัะตะปั โ ะถะผัั โะะพะนัะธ ัะตัะตะท Googleโ.
    
2. ะัะฐัะทะตั โ ะฟะตัะตะฝะฐะฟัะฐะฒะปัะตััั ะฝะฐ `https://accounts.google.com/...`.
    
3. ะะพะปัะทะพะฒะฐัะตะปั ะปะพะณะธะฝะธััั, ัะพะณะปะฐัะฐะตััั ะดะฐัั ะดะพัััะฟ.
    
4. Authorization Server ะฒะพะทะฒัะฐัะฐะตั `code`.
    
5. ะัะธะปะพะถะตะฝะธะต ะพะฑะผะตะฝะธะฒะฐะตั `code` ะฝะฐ **access token** (ะธ ะพะฟัะธะพะฝะฐะปัะฝะพ `refresh token`).
    
6. ะัะธะปะพะถะตะฝะธะต ะธัะฟะพะปัะทัะตั `access token` ะดะปั ะดะพัััะฟะฐ ะบ API.
    

---

### 5. Access Token ะธ Refresh Token

|ะขะธะฟ ัะพะบะตะฝะฐ|ะะฐะทะฝะฐัะตะฝะธะต|ะัะตะผั ะถะธะทะฝะธ|
|---|---|---|
|**Access Token**|ะะพัััะฟ ะบ API ะพั ะธะผะตะฝะธ ะฟะพะปัะทะพะฒะฐัะตะปั|ะะพัะพัะบะพะต (ะพะฑััะฝะพ 1 ัะฐั)|
|**Refresh Token**|ะะพะทะฒะพะปัะตั ะฟะพะปััะธัั ะฝะพะฒัะน access token|ะะพะปะณะพะต (ะดะฝะธ ะธะปะธ ะฝะตะดะตะปะธ)|

---

### 6. ะัะธะผะตั ะพะฑะผะตะฝะฐ ัะพะบะตะฝะฐ (ัะฟัะพััะฝะฝะพ)

```bash
POST /token
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code
&code=abc123
&redirect_uri=https://app.example.com/callback
&client_id=APP_ID
&client_secret=SECRET
```

ะัะฒะตั:

```json
{
  "access_token": "ya29.a0AR...",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "1//0g..."
}
```

---

### 7. Access Token ะฒ ะดะตะนััะฒะธะธ

```bash
GET /userinfo
Authorization: Bearer ya29.a0AR...
```

ะัะปะธ ัะพะบะตะฝ ะธัััะบ โ ะธัะฟะพะปัะทัะตะผ refresh token:

```bash
POST /token
grant_type=refresh_token
&refresh_token=1//0g...
```

---

### 8. ะะดะต ััะฐะฝะธัั ัะพะบะตะฝั

- **Access Token** โ ะฒ ะฟะฐะผััะธ ะธะปะธ HttpOnly-cookie (ะฝะธะบะพะณะดะฐ ะฝะต ะฒ localStorage).
    
- **Refresh Token** โ ัะพะปัะบะพ ะฝะฐ ัะตัะฒะตัะต, ััะพะฑั ะทะปะพัะผััะปะตะฝะฝะธะบ ะฝะต ัะผะพะณ ะตะณะพ ัะบัะฐััั.
    
- **Client Secret** โ ัััะพะณะพ ััะฐะฝะธัั ะฝะฐ ัะตัะฒะตัะต (ะฝะธะบะพะณะดะฐ ะฒ JS-ะบะพะดะต).
    

---

### 9. ะะทะฐะธะผะพะดะตะนััะฒะธะต ั JWT

OAuth 2.0 **ะฝะต ััะตะฑัะตั JWT**, ะฝะพ ัะฐััะพ ัะพะบะตะฝั ัะตะฐะปะธะทััััั ะธะผะตะฝะฝะพ ะบะฐะบ **JWT**:

- ัะดะพะฑะฝะพ ััะฐะฝะธัั `exp`, `sub`, `scope` ะฟััะผะพ ะฒ ัะพะบะตะฝะต;
    
- ัะตัะฒะตั ะผะพะถะตั ะฟัะพะฒะตัััั ะฟะพะดะฟะธัั ะปะพะบะฐะปัะฝะพ, ะฑะตะท ะพะฑัะฐัะตะฝะธั ะบ ะฑะฐะทะต.
    

> JWT โ ััะพ ัะพัะผะฐั ัะพะบะตะฝะฐ.  
> OAuth 2.0 โ ััะพ ัะฟะพัะพะฑ, _ะบะฐะบ ะธ ะบะพะผั_ ััะพั ัะพะบะตะฝ ะฒัะดะฐัััั.

---

### 10. ะัะปะธัะธะต ะพั OpenID Connect (OIDC)

||OAuth 2.0|OpenID Connect|
|---|---|---|
|ะฆะตะปั|ะะฒัะพัะธะทะฐัะธั (ะดะพัััะฟ ะบ ะดะฐะฝะฝัะผ)|ะััะตะฝัะธัะธะบะฐัะธั (ัะทะฝะฐัั, ะบัะพ ะฟะพะปัะทะพะฒะฐัะตะปั)|
|ะขะพะบะตะฝ|Access token|ID token (ัะฐััะพ JWT)|
|ะะพะทะฒัะฐัะฐะตั|ะัะฐะฒะฐ ะดะพัััะฟะฐ (scope)|ะะฝัะพัะผะฐัะธั ะพ ะฟะพะปัะทะพะฒะฐัะตะปะต (email, name ะธ ั.ะด.)|

> โLogin with Googleโ ัะฐะบัะธัะตัะบะธ ะธัะฟะพะปัะทัะตั **OIDC ะฟะพะฒะตัั OAuth2**.

---

### ะกะฒัะทะฐะฝะฝัะต ะทะฐะผะตัะบะธ

- [[JWT (JSON Web Token)]] โ ะพ ัะพัะผะฐัะต ัะพะบะตะฝะพะฒ, ะบะพัะพััะต ัะฐััะพ ะธัะฟะพะปัะทััััั ะฒ OAuth 2.0.
- [[ะกะตััะธะธ (Sessions)]] โ ะบะพะณะดะฐ stateful-ะฟะพะดัะพะด ะฒัั ะตัั ัะดะพะฑะฝะตะต ัะพะบะตะฝะพะฒ.
- [[State (ะกะพััะพัะฝะธะต)]] โ ะฟะพัะตะผั stateless-ะบะพะฝััะฐะบัั ัะฟัะพัะฐัั ัะฐะฑะพัั ั OAuth-ะบะปะธะตะฝัะฐะผะธ.

---

### ๐ก ะ ะพะดะฝะพะน ััะฐะทะต

> **OAuth 2.0** โ ััะพ ัะฟะพัะพะฑ ะดะตะปะตะณะธัะพะฒะฐัั ะดะพัััะฟ ะฑะตะท ะฟะฐัะพะปะตะน:  
> ะฟะพะปัะทะพะฒะฐัะตะปั ะดะพะฒะตััะตั ัะพะบะตะฝ, ะฐ ะฝะต ัะฒะพะธ ััััะฝัะต ะดะฐะฝะฝัะต.  
> ะ ะตัะปะธ ะฝัะถะฝะพ ะธะผะตะฝะฝะพ โะบัะพ ัโ โ ะฟะพะดะบะปััะฐะน OpenID Connect.