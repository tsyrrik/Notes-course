## Вопрос: SSRF (Server-Side Request Forgery)

## Простой ответ
- Не позволяйте пользователю задавать произвольные URL. Жёстко ограничивайте адреса/схемы, проверяйте IP после DNS и изолируйте исходящие запросы.

## Ответ
Простыми словами: злоумышленник заставляет сервер делать HTTP-запросы к внутренним/внешним ресурсам, обходя ACL (например, `http://169.254.169.254` метаданные облака).

## Защита
- Жёсткий allowlist хостов/схем/портов; запрет прямых URL из пользовательского ввода.
- Резолвить DNS и проверять IP против private ranges/localhost/metadata.
- Запрет `file://`, `gopher://`, `ftp://`, подпорты 80/443/localhost, редиректы на них.
- Отдельный сетевой сегмент/прокси без доступа к внутренним сервисам для исходящих запросов от приложения.
- Лимиты таймаутов/размеров ответов; логирование исходящих запросов.

## Примеры

1. Поле URL читает `http://169.254.169.254/latest/meta-data/`.
2. Редирект на `http://127.0.0.1/admin`.
3. Защита: allowlist + проверка IP после DNS.

## Доп. теория

1. SSRF часто комбинируется с DNS‑rebinding/redirects.
2. IMDSv2 снижает риск, но не устраняет его полностью.
