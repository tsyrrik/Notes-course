## Вопрос: CSRF (Cross-Site Request Forgery)

## Простой ответ
- Добавляйте CSRF-токены и SameSite cookies, не доверяйте запросам без вашего токена.

## Ответ

### Что такое CSRF

CSRF (Cross-Site Request Forgery, «подделка межсайтового запроса») — атака, при которой злоумышленник заставляет браузер авторизованного пользователя отправить нежелательный запрос на сайт, где пользователь аутентифицирован. Браузер автоматически прикрепляет cookies (включая session cookie) к каждому запросу на соответствующий домен, и сервер не может отличить легитимный запрос от подделанного.

### Как работает атака

Сценарий атаки: пользователь авторизован на сайте банка (bank.com). Он заходит на сайт злоумышленника (evil.com), где скрыта форма или изображение, которые автоматически отправляют запрос на bank.com. Браузер добавляет cookies банка к запросу, и сервер банка выполняет операцию, думая, что это легитимный запрос пользователя. Атака работает, потому что браузер автоматически прикрепляет cookies к cross-origin запросам (если SameSite не настроен).

### Примеры

1. Автосабмит формы на чужом домене вызывает `POST /transfer`.
2. Защита: CSRF‑токен в форме + проверка на сервере.
3. SameSite=Lax как дополнительный слой.

## Доп. теория

1. CSRF актуален, если аутентификация хранится в cookie.
2. Origin/Referer — дополнительная, но не единственная защита.
