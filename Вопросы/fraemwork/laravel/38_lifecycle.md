## Вопрос: Жизненный цикл HTTP-запроса в Laravel
Версия: Laravel 12.x (актуальная), 11.x в security-fixes; PHP 8.2–8.4.

## Простой ответ
браузер → `public/index.php` → приложение/контейнер → HTTP-ядро → bootstrappers → middleware → маршрутизатор → контроллер/замыкание → ответ → обратный проход через middleware → отправка в браузер.

## Ответ
Запрос попадает в public/index.php, откуда загружается bootstrap/app.php, поднимается приложение и контейнер зависимостей, после чего HTTP-ядро настраивает окружение — конфигурации, логирование и подключение сервис-провайдеров, через которые активируются подсистемы вроде базы данных, очередей, кеша и маршрутизации; далее запрос проходит через цепочку middleware, выполняющих проверки (например, авторизацию или CSRF), попадает в роутер, где находится соответствующий маршрут и вызывается нужный контроллер или замыкание, в который Laravel передаёт объект Request, выполняется валидация данных, затем запускается бизнес-логика с обращением к сервисам, моделям или репозиториям для работы с базой данных, формируется Response (view, JSON или redirect), после чего ответ снова проходит через middleware, и в завершение Laravel отправляет итоговый HTTP-ответ клиенту.




## Подробно по шагам
1) Веб-сервер → точка входа  
- Apache/Nginx направляют запрос в `public/index.php`.  
- Подключается автозагрузчик Composer, поднимается приложение из `bootstrap/app.php`.

2) Приложение и контейнер  
- В `bootstrap/app.php` создаётся Application — DI-контейнер и «скелет» фреймворка.  
- Контейнер хранит сервисы (логгер, БД, роутер и т.д.).

3) Ядро (Kernel)  
- HTTP-запрос обрабатывает `Illuminate\Foundation\Http\Kernel` (`handle($request)` → `Response`).  
- В `app/Http/Kernel.php` перечислены middleware и bootstrappers.

4) Bootstrappers (подготовка окружения)  
- Определение окружения, загрузка конфига, настройка ошибок/логирования, подготовка приложения.

5) Сервис-провайдеры  
- Загружаются провайдеры: `register()` (биндинги в контейнер), затем `boot()` (инициализация, когда сервисы доступны).  
- Через провайдеры подключаются БД, очереди, валидация, маршруты и др.

6) Глобальные middleware (до маршрутов)  
- Режим обслуживания, сессии, CSRF и прочие фильтры до роутера.

7) Маршрутизация  
- Роутер находит маршрут по методу/пути, применяет маршрутные middleware (auth и т.п.), резолвит binding.  
- Вызывает контроллер или замыкание.

8) Контроллер / доменная логика  
- Валидация (часто FormRequest), работа с моделями/сервисами/репозиториями.  
- Формируется `Response`: JSON/HTML/redirect (часто через API Resources).

9) Ответ и обратный проход  
- `Response` идёт обратно через middleware (заголовки, кэш, куки, логирование).

10) Отправка клиенту  
- Ядро возвращает `Response`, вызывается `send()` — ответ уходит клиенту.

11) Terminable middleware  
- Метод `terminate()` выполняется после отправки ответа (логи, метрики без задержки пользователя).

## Где что настраивать (памятка)
- Точка входа: `public/index.php`
- Создание приложения: `bootstrap/app.php`
- HTTP-ядро и списки middleware/bootstrappers: `app/Http/Kernel.php`
- Маршруты: `routes/web.php`, `routes/api.php`
- Провайдеры: `app/Providers/*` (биндинги/инициализация)
- Конфиги: `config/*`
- Глобальные middleware: `$middleware` в Kernel
- Группы/маршрутные middleware: `$middlewareGroups`, `$middlewareAliases`

## Примеры

1. Middleware → Controller → Response.
2. Service Providers `register()` → `boot()`.
3. Kernel выполняет стек middleware.

## Доп. теория

1. Bootstrap грузит конфиг, провайдеры и контейнер.
2. HTTP‑kernel формирует pipeline middleware.
