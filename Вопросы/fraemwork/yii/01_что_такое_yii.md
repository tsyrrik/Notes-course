## Вопрос: Yii2: что это
Версия: Yii2 2.0.54 (ветка 2.0.x); Yii3 релизнут (2025‑12‑31).

## Простой ответ
Быстрый PHP-фреймворк с архитектурой MVC, ориентирован на производительность, удобную конфигурацию и богатую экосистему компонентов (ORM, кэш, RBAC, очереди, REST).

## Ответ

### Что такое Yii2?

Yii2 (аббревиатура «Yes It Is!») — это высокопроизводительный PHP-фреймворк для разработки веб-приложений, построенный по паттерну MVC (Model-View-Controller). Фреймворк был выпущен в октябре 2014 года как полная переработка первой версии Yii, написанной Qiang Xue. Текущая ветка 2.0.x требует минимум PHP 7.4 и поддерживает PHP 8.5. Название «Yii» переводится с китайского как «простой и эволюционирующий», что отражает философию фреймворка — предоставить мощный инструмент, который при этом легко освоить.

### Ключевые особенности Yii2

Yii2 отличается от других PHP-фреймворков несколькими важными чертами. Во-первых, это **lazy loading компонентов** — компоненты приложения создаются только при первом обращении к ним, что экономит ресурсы. Во-вторых, Yii2 предоставляет **генератор кода Gii**, который через веб-интерфейс или консоль позволяет создавать модели, контроллеры, CRUD-интерфейсы и модули. В-третьих, фреймворк включает встроенную поддержку **RBAC** (Role-Based Access Control), **REST API**, **кэширования**, **очередей**, **интернационализации** и многого другого «из коробки».

```php
// Точка входа приложения — web/index.php
require __DIR__ . '/../vendor/autoload.php';
require __DIR__ . '/../vendor/yiisoft/yii2/Yii.php';

$config = require __DIR__ . '/../config/web.php';
(new yii\web\Application($config))->run();
```

### Yii::$app — сердце приложения

Центральным объектом Yii2 является синглтон `Yii::$app` — экземпляр класса `yii\web\Application` (или `yii\console\Application` для консоли). Через него доступны все компоненты приложения: база данных (`Yii::$app->db`), кэш (`Yii::$app->cache`), почта (`Yii::$app->mailer`), пользователь (`Yii::$app->user`) и любые пользовательские сервисы. Это реализация паттерна Service Locator — вы регистрируете компонент в конфигурации, а затем обращаетесь к нему по имени.

```php
// Обращение к компонентам через Yii::$app
$db = Yii::$app->db;               // подключение к БД
$cache = Yii::$app->cache;         // кэш
$user = Yii::$app->user;           // компонент авторизации
$mailer = Yii::$app->mailer;       // отправка писем
$params = Yii::$app->params;       // параметры приложения

// Проверка, является ли пользователь гостем
if (Yii::$app->user->isGuest) {
    return $this->redirect(['site/login']);
}
```

### ActiveRecord и Query Builder

Yii2 предоставляет мощный ORM на основе паттерна Active Record. Каждая таблица в БД может быть представлена классом-моделью, который позволяет работать с записями как с объектами. Помимо ActiveRecord, Yii2 имеет гибкий Query Builder для построения SQL-запросов программно, а также поддерживает raw SQL для сложных случаев.

```php
// ActiveRecord — работа с записями как с объектами
$post = Post::findOne(1);
$post->title = 'Новый заголовок';
$post->save();

// Query Builder — построение запросов
$rows = (new \yii\db\Query())
    ->select(['id', 'title'])
    ->from('post')
    ->where(['status' => 1])
    ->orderBy('created_at DESC')
    ->limit(10)
    ->all();

// Связи (relations)
$comments = $post->getComments()->where(['status' => 1])->all();
```

### Система валидации и сценарии

Валидация в Yii2 встроена на уровне модели. Правила описываются в методе `rules()`, а сценарии позволяют применять разные наборы правил в разных контекстах (создание, обновление, импорт). Это обеспечивает единый подход к проверке данных — и для форм, и для API.

```php
class Post extends \yii\db\ActiveRecord
{
    public function rules()
    {
        return [
            [['title', 'body'], 'required'],
            ['title', 'string', 'max' => 255],
            ['status', 'in', 'range' => [0, 1]],
            ['email', 'email'],
            ['created_at', 'default', 'value' => time()],
        ];
    }
}
```

### Экосистема и расширения

Yii2 имеет богатую экосистему расширений, устанавливаемых через Composer. Официальные расширения включают: `yii2-redis`, `yii2-queue`, `yii2-elasticsearch`, `yii2-mongodb`, `yii2-authclient` (OAuth-авторизация через социальные сети), `yii2-httpclient`, `yii2-imagine` (обработка изображений). Сообщество поддерживает сотни дополнительных пакетов. Два официальных шаблона приложений — **basic** (для небольших проектов) и **advanced** (с разделением на frontend/backend/console) — помогают быстро начать разработку.

```bash
# Установка Yii2 через Composer
composer create-project --prefer-dist yiisoft/yii2-app-basic myproject
# Или advanced-шаблон
composer create-project --prefer-dist yiisoft/yii2-app-advanced myproject
```

### Практические советы

При выборе Yii2 для проекта стоит учитывать следующее: фреймворк отлично подходит для корпоративных приложений, CRM, админок и проектов со сложной бизнес-логикой благодаря встроенному RBAC, Gii и мощной работе с формами. Yii2 показывает высокую производительность «из коробки» — lazy loading компонентов, кэширование схемы БД, поддержка opcache. Для новых проектов, особенно «с нуля», стоит рассмотреть Yii3: он построен на PSR‑стандартах, поддерживает PHP 8.2+ и активно использует DI, а Yii2 сохраняет сервис‑локатор как основной стиль.

## Примеры

1. Старт проекта: `composer create-project --prefer-dist yiisoft/yii2-app-basic basic`.
2. Доступ к компоненту: `Yii::$app->db->createCommand('SELECT 1')->queryScalar();`.
3. ActiveRecord: `Post::find()->where(['status' => 1])->all();`.

## Доп. теория

1. Yii2 опирается на Service Locator (`Yii::$app`), что упрощает доступ к сервисам, но усложняет тестирование.
2. Yii3 — пакетная экосистема на PSR‑интерфейсах с акцентом на DI и совместимость с современными PHP‑компонентами.
