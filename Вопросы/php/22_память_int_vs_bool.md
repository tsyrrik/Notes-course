## Вопрос: Память: int vs bool
Версия: PHP 8.4; где есть исторические детали — см. по тексту.

## Простой ответ
в PHP скаляры лежат в `zval`, разница между `int` и `bool` по памяти/скорости несущественна — важнее структура данных (массивы, объекты) и количество элементов.

## Ответ

### Внутреннее представление (zval)

Каждое значение в PHP хранится в структуре `zval` (Zend Value). На 64‑битной системе это **порядка 16 байт** на zval, но точный размер зависит от версии и сборки PHP:

```
zval = {
    value:  8 байт (union: int, double, pointer)
    type:   4 байта (тег типа + флаги)
    // + выравнивание
}
```

- `int` → значение хранится в `zend_long` (8 байт) внутри zval
- `bool` → хранится как `zend_long` со значением 0 или 1
- `float` → хранится как `double` (8 байт)

**Вывод**: разница в потреблении памяти между `int` и `bool` — **нулевая**. Оба занимают один zval.

### Что реально влияет на память

| Структура | Накладные расходы |
| --- | --- |
| `array` | десятки байт базовых + bucket + zval для каждого элемента |
| `object` | десятки байт + таблица свойств |
| `string` | заголовок + длина строки |
| `int`/`bool`/`float` | один zval (≈ одинаково) |

### Практические рекомендации

1. **Массивы** — главный потребитель памяти. 1 000 000 int'ов в массиве ≈ 48 МБ. SplFixedArray экономит ~30%.
2. **Генераторы** вместо массивов — для потоковой обработки больших коллекций.
3. **COW** — не копируйте массивы явно и не используйте `&` без необходимости.
4. **Строки** — интернирование (interning): одинаковые строки из исходного кода хранятся один раз.

## Примеры
```php
// Плохо: 1M элементов в массиве (~48 МБ)
$data = range(1, 1_000_000);

// Хорошо: генератор (пара КБ)
function generate(): Generator {
    for ($i = 1; $i <= 1_000_000; $i++) {
        yield $i;
    }
}

// Проверка памяти
echo memory_get_usage(true);       // текущее потребление
echo memory_get_peak_usage(true);  // пиковое потребление
```

## Доп. теория
- Точные размеры зависят от версии PHP, сборки, allocator и включённых опций.
- С точки зрения памяти главное — **структура данных**, а не выбор `int` vs `bool`.
