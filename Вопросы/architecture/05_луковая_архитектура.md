## Вопрос: Луковая архитектура (Onion Architecture)

## Простой ответ
- Домен в центре ничего не знает о внешнем мире; внешние детали подключаются как плагины через интерфейсы.
- Похоже на слоистую, но жёстче заставляет зависеть только внутрь.
- Хорошо, если хотим легко менять БД/фреймворки и тестировать домен изолированно.

## Ответ
Вариант, где зависимости направлены только внутрь — к домену; внешние слои зависят от внутренних, а не наоборот.

## Кольца
- Domain (ядро): сущности, Value Objects, доменные сервисы, интерфейсы репозиториев.
- Application: use-case'ы/Handlers, транзакции, оркестрация.
- Interfaces/Adapters: реализации репозиториев, gateways, controllers, CLI adapters.
- Infrastructure: детали (ORM, HTTP клиент, БД, очереди) — подключается как внешний слой к интерфейсам.

## Принцип
- Dependency Rule: код внешнего слоя может зависеть на внутренний, но не наоборот.
- Связь наружу — через интерфейсы, реализуемые во внешних слоях.

## Пример зависимостей
```
Domain <- Application <- Adapters (HTTP/DB/Queue) <- Infrastructure libs
```

## Плюсы / минусы
- + Домен изолирован от фреймворков/БД; легко менять инфраструктуру.
- + Тестируемость: домен тестируется без окружения.
- – Больше абстракций/слоёв, требуется дисциплина и шаблоны.
